function Duplex(a){return this instanceof Duplex?(Readable.call(this,a),Writable.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(a)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}module.exports=Duplex;var objectKeys=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(a){Duplex.prototype[a]||(Duplex.prototype[a]=Writable.prototype[a])});