var expect=require("expect.js"),cheerio=require("../.."),food=require("../fixtures").food,fruits=require("../fixtures").fruits,drinks=require("../fixtures").drinks,text=require("../fixtures").text;describe("$(...)",function(){var a;beforeEach(function(){a=cheerio.load(fruits)}),describe(".find",function(){it("() : should find nothing",function(){expect(a("ul").find()).to.have.length(0)}),it("(single) : should find one descendant",function(){expect(a("#fruits").find(".apple")[0].attribs["class"]).to.equal("apple")}),it("(many) : should find all matching descendant",function(){expect(a("#fruits").find("li")).to.have.length(3)}),it("(many) : should merge all selected elems with matching descendants",function(){expect(a("#fruits, #food",food).find(".apple")).to.have.length(1)}),it("(invalid single) : should return empty if cant find",function(){expect(a("ul").find("blah")).to.have.length(0)}),it("(invalid single) : should query descendants only",function(){expect(a("#fruits").find("ul")).to.have.length(0)}),it("should return empty if search already empty result",function(){expect(a("#not-fruits").find("li")).to.have.length(0)}),it("should lowercase selectors",function(){expect(a("#fruits").find("LI")).to.have.length(3)}),it("should query case-sensitively when in xmlMode",function(){var a=cheerio.load("<caseSenSitive allTheWay>",{xmlMode:!0});expect(a("caseSenSitive")).to.have.length(1),expect(a("[allTheWay]")).to.have.length(1),expect(a("casesensitive")).to.have.length(0),expect(a("[alltheway]")).to.have.length(0)}),it("should throw a SyntaxError if given an invalid selector",function(){expect(function(){a("#fruits").find(":bah")}).to.throwException(function(a){expect(a).to.be.a(SyntaxError)})}),describe("(cheerio object) :",function(){it("returns only those nodes contained within the current selection",function(){var a=cheerio.load(food),b=a("#fruits").find(a("li"));expect(b).to.have.length(3),expect(b[0]).to.be(a(".apple")[0]),expect(b[1]).to.be(a(".orange")[0]),expect(b[2]).to.be(a(".pear")[0])}),it("returns only those nodes contained within any element in the current selection",function(){var a=cheerio.load(food),b=a(".apple, #vegetables").find(a("li"));expect(b).to.have.length(2),expect(b[0]).to.be(a(".carrot")[0]),expect(b[1]).to.be(a(".sweetcorn")[0])})}),describe("(node) :",function(){it("returns node when contained within the current selection",function(){var a=cheerio.load(food),b=a("#fruits").find(a(".apple")[0]);expect(b).to.have.length(1),expect(b[0]).to.be(a(".apple")[0])}),it("returns node when contained within any element the current selection",function(){var a=cheerio.load(food),b=a("#fruits, #vegetables").find(a(".carrot")[0]);expect(b).to.have.length(1),expect(b[0]).to.be(a(".carrot")[0])}),it("does not return node that is not contained within the current selection",function(){var a=cheerio.load(food),b=a("#fruits").find(a(".carrot")[0]);expect(b).to.have.length(0)})})}),describe(".children",function(){it("() : should get all children",function(){expect(a("ul").children()).to.have.length(3)}),it("() : should return children of all matched elements",function(){expect(a("ul ul",food).children()).to.have.length(5)}),it("(selector) : should return children matching selector",function(){var b=a("ul").children(".orange")[0].attribs["class"];expect(b).to.equal("orange")}),it("(invalid selector) : should return empty",function(){expect(a("ul").children(".lulz")).to.have.length(0)}),it("should only match immediate children, not ancestors",function(){expect(a(food).children("li")).to.have.length(0)})}),describe(".contents",function(){beforeEach(function(){a=cheerio.load(text)}),it("() : should get all contents",function(){expect(a("p").contents()).to.have.length(5)}),it("() : should include text nodes",function(){expect(a("p").contents().first()[0].type).to.equal("text")}),it("() : should include comment nodes",function(){expect(a("p").contents().last()[0].type).to.equal("comment")})}),describe(".next",function(){it("() : should return next element",function(){var b=a(".orange").next()[0].attribs["class"];expect(b).to.equal("pear")}),it("(no next) : should return empty for last child",function(){expect(a(".pear").next()).to.have.length(0)}),it("(next on empty object) : should return empty",function(){expect(a(".banana").next()).to.have.length(0)}),it("() : should operate over all elements in the selection",function(){expect(a(".apple, .orange",food).next()).to.have.length(2)}),describe("(selector) :",function(){it("should reject elements that violate the filter",function(){expect(a(".apple").next(".non-existent")).to.have.length(0)}),it("should accept elements that satisify the filter",function(){expect(a(".apple").next(".orange")).to.have.length(1)})})}),describe(".nextAll",function(){it("() : should return all following siblings",function(){var b=a(".apple").nextAll();expect(b).to.have.length(2),expect(b[0].attribs["class"]).to.equal("orange"),expect(b[1].attribs["class"]).to.equal("pear")}),it("(no next) : should return empty for last child",function(){expect(a(".pear").nextAll()).to.have.length(0)}),it("(nextAll on empty object) : should return empty",function(){expect(a(".banana").nextAll()).to.have.length(0)}),it("() : should operate over all elements in the selection",function(){expect(a(".apple, .carrot",food).nextAll()).to.have.length(3)}),it("() : should not contain duplicate elements",function(){var b=a(".apple, .orange",food);expect(b.nextAll()).to.have.length(2)}),describe("(selector) :",function(){it("should filter according to the provided selector",function(){expect(a(".apple").nextAll(".pear")).to.have.length(1)}),it("should not consider siblings' contents when filtering",function(){expect(a("#fruits",food).nextAll("li")).to.have.length(0)})})}),describe(".nextUntil",function(){it("() : should return all following siblings if no selector specified",function(){var b=a(".apple",food).nextUntil();expect(b).to.have.length(2),expect(b[0].attribs["class"]).to.equal("orange"),expect(b[1].attribs["class"]).to.equal("pear")}),it("() : should filter out non-element nodes",function(){var b=a("<div><div></div><!-- comment -->text<div></div></div>"),c=b.children().eq(0);expect(c.nextUntil()).to.have.length(1)}),it("() : should operate over all elements in the selection",function(){var b=a(".apple, .carrot",food);expect(b.nextUntil()).to.have.length(3)}),it("() : should not contain duplicate elements",function(){var b=a(".apple, .orange",food);expect(b.nextUntil()).to.have.length(2)}),it("(selector) : should return all following siblings until selector",function(){var b=a(".apple",food).nextUntil(".pear");expect(b).to.have.length(1),expect(b[0].attribs["class"]).to.equal("orange")}),it("(selector not sibling) : should return all following siblings",function(){var b=a(".apple").nextUntil("#vegetables");expect(b).to.have.length(2)}),it("(selector, filterString) : should return all following siblings until selector, filtered by filter",function(){var b=a(".beer",drinks).nextUntil(".water",".milk");expect(b).to.have.length(1),expect(b[0].attribs["class"]).to.equal("milk")}),it("(null, filterString) : should return all following siblings until selector, filtered by filter",function(){var b=a("<ul><li></li><li><p></p></li></ul>"),c=b.find("li").eq(0).nextUntil(null,"p");expect(c).to.have.length(0)}),it("() : should return an empty object for last child",function(){expect(a(".pear").nextUntil()).to.have.length(0)}),it("() : should return an empty object when called on an empty object",function(){expect(a(".banana").nextUntil()).to.have.length(0)}),it("(node) : should return all following siblings until the node",function(){var b=a("#fruits").children(),c=b.eq(0).nextUntil(b[2]);expect(c).to.have.length(1)}),it("(cheerio object) : should return all following siblings until any member of the cheerio object",function(){var b=a(drinks).children(),c=a([b[4],b[3]]),d=b.eq(0).nextUntil(c);expect(d).to.have.length(2)})}),describe(".prev",function(){it("() : should return previous element",function(){var b=a(".orange").prev()[0].attribs["class"];expect(b).to.equal("apple")}),it("(no prev) : should return empty for first child",function(){expect(a(".apple").prev()).to.have.length(0)}),it("(prev on empty object) : should return empty",function(){expect(a(".banana").prev()).to.have.length(0)}),it("() : should operate over all elements in the selection",function(){expect(a(".orange, .pear",food).prev()).to.have.length(2)}),describe("(selector) :",function(){it("should reject elements that violate the filter",function(){expect(a(".orange").prev(".non-existent")).to.have.length(0)}),it("should accept elements that satisify the filter",function(){expect(a(".orange").prev(".apple")).to.have.length(1)})})}),describe(".prevAll",function(){it("() : should return all preceding siblings",function(){var b=a(".pear").prevAll();expect(b).to.have.length(2),expect(b[0].attribs["class"]).to.equal("orange"),expect(b[1].attribs["class"]).to.equal("apple")}),it("(no prev) : should return empty for first child",function(){expect(a(".apple").prevAll()).to.have.length(0)}),it("(prevAll on empty object) : should return empty",function(){expect(a(".banana").prevAll()).to.have.length(0)}),it("() : should operate over all elements in the selection",function(){expect(a(".orange, .sweetcorn",food).prevAll()).to.have.length(2)}),it("() : should not contain duplicate elements",function(){var b=a(".orange, .pear",food);expect(b.prevAll()).to.have.length(2)}),describe("(selector) :",function(){it("should filter returned elements",function(){var b=a(".pear").prevAll(".apple");expect(b).to.have.length(1)}),it("should not consider siblings's descendents",function(){var b=a("#vegetables",food).prevAll("li");expect(b).to.have.length(0)})})}),describe(".prevUntil",function(){it("() : should return all preceding siblings if no selector specified",function(){var b=a(".pear").prevUntil();expect(b).to.have.length(2),expect(b[0].attribs["class"]).to.equal("orange"),expect(b[1].attribs["class"]).to.equal("apple")}),it("() : should filter out non-element nodes",function(){var b=a('<div class="1"><div class="2"></div><!-- comment -->text<div class="3"></div></div>'),c=b.children().last();expect(c.prevUntil()).to.have.length(1)}),it("() : should operate over all elements in the selection",function(){var b=a(".pear, .sweetcorn",food);expect(b.prevUntil()).to.have.length(3)}),it("() : should not contain duplicate elements",function(){var b=a(".orange, .pear",food);expect(b.prevUntil()).to.have.length(2)}),it("(selector) : should return all preceding siblings until selector",function(){var b=a(".pear").prevUntil(".apple");expect(b).to.have.length(1),expect(b[0].attribs["class"]).to.equal("orange")}),it("(selector not sibling) : should return all preceding siblings",function(){var b=a(".sweetcorn",food).prevUntil("#fruits");expect(b).to.have.length(1),expect(b[0].attribs["class"]).to.equal("carrot")}),it("(selector, filterString) : should return all preceding siblings until selector, filtered by filter",function(){var b=a(".cider",drinks).prevUntil(".juice",".water");expect(b).to.have.length(1),expect(b[0].attribs["class"]).to.equal("water")}),it("(selector, filterString) : should return all preceding siblings until selector",function(){var b=a("<ul><li><p></p></li><li></li></ul>"),c=b.find("li").eq(1).prevUntil(null,"p");expect(c).to.have.length(0)}),it("() : should return an empty object for first child",function(){expect(a(".apple").prevUntil()).to.have.length(0)}),it("() : should return an empty object when called on an empty object",function(){expect(a(".banana").prevUntil()).to.have.length(0)}),it("(node) : should return all previous siblings until the node",function(){var b=a("#fruits").children(),c=b.eq(2).prevUntil(b[0]);expect(c).to.have.length(1)}),it("(cheerio object) : should return all previous siblings until any member of the cheerio object",function(){var b=a(drinks).children(),c=a([b[0],b[1]]),d=b.eq(4).prevUntil(c);expect(d).to.have.length(2)})}),describe(".siblings",function(){it("() : should get all the siblings",function(){expect(a(".orange").siblings()).to.have.length(2),expect(a("#fruits").siblings()).to.have.length(0),expect(a(".apple, .carrot",food).siblings()).to.have.length(3)}),it("(selector) : should get all siblings that match the selector",function(){expect(a(".orange").siblings(".apple")).to.have.length(1),expect(a(".orange").siblings(".peach")).to.have.length(0)}),it("(selector) : should throw a SyntaxError if given an invalid selector",function(){expect(function(){a(".orange").siblings(":bah")}).to.throwException(function(a){expect(a).to.be.a(SyntaxError)})}),it("(selector) : does not consider the contents of siblings when filtering (GH-374)",function(){expect(a("#fruits",food).siblings("li")).to.have.length(0)})}),describe(".parents",function(){beforeEach(function(){a=cheerio.load(food)}),it("() : should get all of the parents in logical order",function(){var b=a(".orange").parents();expect(b).to.have.length(2),expect(b[0].attribs.id).to.be("fruits"),expect(b[1].attribs.id).to.be("food"),b=a("#fruits").parents(),expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("food")}),it("(selector) : should get all of the parents that match the selector in logical order",function(){var b=a(".orange").parents("#fruits");expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("fruits"),b=a(".orange").parents("ul"),expect(b).to.have.length(2),expect(b[0].attribs.id).to.be("fruits"),expect(b[1].attribs.id).to.be("food")}),it("() : should not break if the selector does not have any results",function(){var b=a(".saladbar").parents();expect(b).to.have.length(0)}),it("() : should return an empty set for top-level elements",function(){var b=a("#food").parents();expect(b).to.have.length(0)}),it("() : should return the parents of every element in the *reveresed* collection, omitting duplicates",function(){var b=a("li").parents();expect(b).to.have.length(3),expect(b[0]).to.be(a("#vegetables")[0]),expect(b[1]).to.be(a("#food")[0]),expect(b[2]).to.be(a("#fruits")[0])})}),describe(".parentsUntil",function(){beforeEach(function(){a=cheerio.load(food)}),it("() : should get all of the parents in logical order",function(){var b=a(".orange").parentsUntil();expect(b).to.have.length(2),expect(b[0].attribs.id).to.be("fruits"),expect(b[1].attribs.id).to.be("food")}),it("() : should get all of the parents in reversed order, omitting duplicates",function(){var b=a(".apple, .sweetcorn").parentsUntil();expect(b).to.have.length(3),expect(b[0].attribs.id).to.be("vegetables"),expect(b[1].attribs.id).to.be("food"),expect(b[2].attribs.id).to.be("fruits")}),it("(selector) : should get all of the parents until selector",function(){var b=a(".orange").parentsUntil("#food");expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("fruits"),b=a(".orange").parentsUntil("#fruits"),expect(b).to.have.length(0)}),it("(selector not parent) : should return all parents",function(){var b=a(".orange").parentsUntil(".apple");expect(b).to.have.length(2),expect(b[0].attribs.id).to.be("fruits"),expect(b[1].attribs.id).to.be("food")}),it("(selector, filter) : should get all of the parents that match the filter",function(){var b=a(".apple, .sweetcorn").parentsUntil(".saladbar","#vegetables");expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("vegetables")}),it("() : should return empty object when called on an empty object",function(){var b=a(".saladbar").parentsUntil();expect(b).to.have.length(0)}),it("() : should return an empty set for top-level elements",function(){var b=a("#food").parentsUntil();expect(b).to.have.length(0)}),it("(cheerio object) : should return all parents until any member of the cheerio object",function(){var b=a("#fruits"),c=a("#food"),d=b.children().eq(1).parentsUntil(c);expect(d).to.have.length(1),expect(d[0].attribs.id).to.be("fruits")})}),describe(".parent",function(){it("() : should return the parent of each matched element",function(){var b=a(".orange").parent();expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("fruits"),b=a("li",food).parent(),expect(b).to.have.length(2),expect(b[0].attribs.id).to.be("fruits"),expect(b[1].attribs.id).to.be("vegetables")}),it("() : should return an empty object for top-level elements",function(){var b=a("ul").parent();expect(b).to.have.length(0)}),it("() : should not contain duplicate elements",function(){var b=a("li").parent();expect(b).to.have.length(1)}),it("(selector) : should filter the matched parent elements by the selector",function(){var b=a(".orange").parent();expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("fruits"),b=a("li",food).parent("#fruits"),expect(b).to.have.length(1),expect(b[0].attribs.id).to.be("fruits")})}),describe(".closest",function(){it("() : should return an empty array",function(){var b=a(".orange").closest();expect(b).to.have.length(0),expect(b).to.be.a(cheerio)}),it("(selector) : should find the closest element that matches the selector, searching through its ancestors and itself",function(){expect(a(".orange").closest(".apple")).to.have.length(0);var b=a(".orange",food).closest("#food");expect(b[0].attribs.id).to.be("food"),b=a(".orange",food).closest("ul"),expect(b[0].attribs.id).to.be("fruits"),b=a(".orange",food).closest("li"),expect(b[0].attribs["class"]).to.be("orange")}),it("(selector) : should find the closest element of each item, removing duplicates",function(){var b=a("li",food).closest("ul");expect(b).to.have.length(2)}),it("() : should not break if the selector does not have any results",function(){var b=a(".saladbar",food).closest("ul");expect(b).to.have.length(0)})}),describe(".each",function(){it("( (i, elem) -> ) : should loop selected returning fn with (i, elem)",function(){var b=[],c=["apple","orange","pear"];a("li").each(function(a,d){b[a]=d,expect(this.attribs["class"]).to.equal(c[a])}),expect(b[0].attribs["class"]).to.equal("apple"),expect(b[1].attribs["class"]).to.equal("orange"),expect(b[2].attribs["class"]).to.equal("pear")}),it("( (i, elem) -> ) : should break iteration when the iterator function returns false",function(){var b=0;a("li").each(function(a){return b++,1>a}),expect(b).to.equal(2)})}),describe(".map",function(){it("(fn) : should be invoked with the correct arguments and context",function(){var b=a("li"),c=[],d=[];b.map(function(){c.push(Array.prototype.slice.call(arguments)),d.push(this)}),expect(c).to.eql([[0,b[0]],[1,b[1]],[2,b[2]]]),expect(d).to.eql([b[0],b[1],b[2]])}),it("(fn) : should return an Cheerio object wrapping the returned items",function(){var b=a("li"),c=b.map(function(a){return b[2-a]});expect(c).to.have.length(3),expect(c[0]).to.be(b[2]),expect(c[1]).to.be(b[1]),expect(c[2]).to.be(b[0])}),it("(fn) : should ignore `null` and `undefined` returned by iterator",function(){var b=a("li"),c=[null,void 0,b[1]],d=b.map(function(a){return c[a]});expect(d).to.have.length(1),expect(d[0]).to.be(b[1])}),it("(fn) : should preform a shallow merge on arrays returned by iterator",function(){var b=a("li"),c=b.map(function(){return[1,[3,4]]});expect(c.get()).to.eql([1,[3,4],1,[3,4],1,[3,4]])}),it("(fn) : should tolerate `null` and `undefined` when flattening arrays returned by iterator",function(){var b=a("li"),c=b.map(function(){return[null,void 0]});expect(c.get()).to.eql([null,void 0,null,void 0,null,void 0])})}),describe(".filter",function(){it("(selector) : should reduce the set of matched elements to those that match the selector",function(){var b=a("li").filter(".pear").text();expect(b).to.be("Pear")}),it("(selector) : should not consider nested elements",function(){var b=a("#fruits").filter("li");expect(b).to.have.length(0)}),it("(selection) : should reduce the set of matched elements to those that are contained in the provided selection",function(){var b=a("li"),c=b.filter(".pear, .apple");expect(b.filter(c)).to.have.length(2)}),it("(element) : should reduce the set of matched elements to those that specified directly",function(){var b=a("li"),c=b.filter(".pear")[0];expect(b.filter(c)).to.have.length(1)}),it("(fn) : should reduce the set of matched elements to those that pass the function's test",function(){var b=a("li").filter(function(b,c){return expect(this).to.be(c),expect(c.tagName).to.be("li"),expect(b).to.be.a("number"),"orange"===a(this).attr("class")}).text();expect(b).to.be("Orange")})}),describe(".not",function(){it("(selector) : should reduce the set of matched elements to those that do not match the selector",function(){var b=a("li"),c=b.not(".pear");expect(c).to.have.length(2),expect(c[0]).to.be(b[0]),expect(c[1]).to.be(b[1])}),it("(selector) : should not consider nested elements",function(){var b=a("#fruits").not("li");expect(b).to.have.length(1)}),it("(selection) : should reduce the set of matched elements to those that are mot contained in the provided selection",function(){var b=a("li"),c=a(".orange"),d=b.not(c);expect(d).to.have.length(2),expect(d[0]).to.be(b[0]),expect(d[1]).to.be(b[2])}),it("(element) : should reduce the set of matched elements to those that specified directly",function(){var b=a("li"),c=a(".apple")[0],d=b.not(c);expect(d).to.have.length(2),expect(d[0]).to.be(b[1]),expect(d[1]).to.be(b[2])}),it("(fn) : should reduce the set of matched elements to those that do not pass the function's test",function(){var b=a("li"),c=b.not(function(b,c){return expect(this).to.be(c),expect(c.name).to.be("li"),expect(b).to.be.a("number"),"orange"===a(this).attr("class")});expect(c).to.have.length(2),expect(c[0]).to.be(b[0]),expect(c[1]).to.be(b[2])})}),describe(".has",function(){beforeEach(function(){a=cheerio.load(food)}),it("(selector) : should reduce the set of matched elements to those with descendants that match the selector",function(){var b=a("#fruits,#vegetables").has(".pear");expect(b).to.have.length(1),expect(b[0]).to.be(a("#fruits")[0])}),it("(selector) : should only consider nested elements",function(){var b=a("#fruits").has("#fruits");expect(b).to.have.length(0)}),it("(element) : should reduce the set of matched elements to those that are ancestors of the provided element",function(){var b=a("#fruits,#vegetables").has(a(".pear")[0]);expect(b).to.have.length(1),expect(b[0]).to.be(a("#fruits")[0])}),it("(element) : should only consider nested elements",function(){var b=a("#fruits"),c=b[0],d=b.has(c);expect(d).to.have.length(0)})}),describe(".first",function(){it("() : should return the first item",function(){var b=a("<span>foo</span><span>bar</span><span>baz</span>"),c=b.first();expect(c.length).to.equal(1),expect(c[0].childNodes[0].data).to.equal("foo")}),it("() : should return an empty object for an empty object",function(){var b=a(),c=b.first();expect(c.length).to.equal(0),expect(c[0]).to.be(void 0)})}),describe(".last",function(){it("() : should return the last element",function(){var b=a("<span>foo</span><span>bar</span><span>baz</span>"),c=b.last();expect(c.length).to.equal(1),expect(c[0].childNodes[0].data).to.equal("baz")}),it("() : should return an empty object for an empty object",function(){var b=a(),c=b.last();expect(c.length).to.equal(0),expect(c[0]).to.be(void 0)})}),describe(".first & .last",function(){it("() : should return equivalent collections if only one element",function(){var b=a("<span>bar</span>"),c=b.first(),d=b.last();expect(c.length).to.equal(1),expect(c[0].childNodes[0].data).to.equal("bar"),expect(d.length).to.equal(1),expect(d[0].childNodes[0].data).to.equal("bar"),expect(c[0]).to.equal(d[0])})}),describe(".eq",function(){function b(a){return a.length?a[0].childNodes[0].data:""}it("(i) : should return the element at the specified index",function(){expect(b(a("li").eq(0))).to.equal("Apple"),expect(b(a("li").eq(1))).to.equal("Orange"),expect(b(a("li").eq(2))).to.equal("Pear"),expect(b(a("li").eq(3))).to.equal(""),expect(b(a("li").eq(-1))).to.equal("Pear")})}),describe(".get",function(){it("(i) : should return the element at the specified index",function(){var b=a("#fruits").children();expect(b.get(0)).to.be(b[0]),expect(b.get(1)).to.be(b[1]),expect(b.get(2)).to.be(b[2])}),it("(-1) : should return the element indexed from the end of the collection",function(){var b=a("#fruits").children();expect(b.get(-1)).to.be(b[2]),expect(b.get(-2)).to.be(b[1]),expect(b.get(-3)).to.be(b[0])}),it("() : should return an array containing all of the collection",function(){var b=a("#fruits").children(),c=b.get();expect(Array.isArray(c)).to.be.ok(),expect(c).to.eql([b[0],b[1],b[2]])})}),describe(".index",function(){describe("() : ",function(){it("returns the index of a child amongst its siblings",function(){expect(a(".orange").index()).to.be(1)}),it("returns -1 when the selection has no parent",function(){expect(a("<div/>").index()).to.be(-1)})}),describe("(selector) : ",function(){it("returns the index of the first element in the set matched by `selector`",function(){expect(a(".apple").index("#fruits, li")).to.be(1)}),it("returns -1 when the item is not present in the set matched by `selector`",function(){expect(a(".apple").index("#fuits")).to.be(-1)}),it("returns -1 when the first element in the set has no parent",function(){expect(a("<div/>").index("*")).to.be(-1)})}),describe("(node) : ",function(){it("returns the index of the given node within the current selection",function(){var b=a("li");expect(b.index(b.get(1))).to.be(1)}),it("returns the index of the given node within the current selection when the current selection has no parent",function(){var b=a(".apple").remove();expect(b.index(b.get(0))).to.be(0)}),it("returns -1 when the given node is not present in the current selection",function(){expect(a("li").index(a("#fruits").get(0))).to.be(-1)}),it("returns -1 when the current selection is empty",function(){expect(a(".not-fruit").index(a("#fruits").get(0))).to.be(-1)})}),describe("(selection) : ",function(){it("returns the index of the first node in the provided selection within the current selection",function(){var b=a("li");expect(b.index(a(".orange, .pear"))).to.be(1)}),it("returns -1 when the given node is not present in the current selection",function(){expect(a("li").index(a("#fruits"))).to.be(-1)}),it("returns -1 when the current selection is empty",function(){expect(a(".not-fruit").index(a("#fruits"))).to.be(-1)})})}),describe(".slice",function(){function b(a){return a.length?a[0].childNodes[0].data:""}it("(start) : should return all elements after the given index",function(){var c=a("li").slice(1);expect(c).to.have.length(2),expect(b(c.eq(0))).to.equal("Orange"),expect(b(c.eq(1))).to.equal("Pear")}),it("(start, end) : should return all elements matching the given range",function(){var c=a("li").slice(1,2);expect(c).to.have.length(1),expect(b(c.eq(0))).to.equal("Orange")}),it("(-start) : should return element matching the offset from the end",function(){var c=a("li").slice(-1);expect(c).to.have.length(1),expect(b(c.eq(0))).to.equal("Pear")})}),describe(".end() :",function(){var b;beforeEach(function(){b=a("#fruits").children()}),it("returns an empty object at the end of the chain",function(){expect(b.end().end().end()).to.be.ok(),expect(b.end().end().end()).to.have.length(0)}),it("find",function(){expect(b.find(".apple").end()).to.be(b)}),it("filter",function(){expect(b.filter(".apple").end()).to.be(b)}),it("map",function(){expect(b.map(function(){return this}).end()).to.be(b)}),it("contents",function(){expect(b.contents().end()).to.be(b)}),it("eq",function(){expect(b.eq(1).end()).to.be(b)}),it("first",function(){expect(b.first().end()).to.be(b)}),it("last",function(){expect(b.last().end()).to.be(b)}),it("slice",function(){expect(b.slice(1).end()).to.be(b)}),it("children",function(){expect(b.children().end()).to.be(b)}),it("parent",function(){expect(b.parent().end()).to.be(b)}),it("parents",function(){expect(b.parents().end()).to.be(b)}),it("closest",function(){expect(b.closest("ul").end()).to.be(b)}),it("siblings",function(){expect(b.siblings().end()).to.be(b)}),it("next",function(){expect(b.next().end()).to.be(b)}),it("nextAll",function(){expect(b.nextAll().end()).to.be(b)}),it("prev",function(){expect(b.prev().end()).to.be(b)}),it("prevAll",function(){expect(b.prevAll().end()).to.be(b)}),it("clone",function(){expect(b.clone().end()).to.be(b)})}),describe(".add",function(){var a=cheerio.load(food),b=a("#fruits"),c=a(".apple"),d=a(".orange"),e=a(".pear"),f=a(".carrot"),g=a(".sweetcorn");describe("(selector",function(){describe(") :",function(){describe("matched element",function(){it("occurs before current selection",function(){var a=d.add(".apple");expect(a).to.have.length(2),expect(a[0]).to.be(c[0]),expect(a[1]).to.be(d[0])}),it("is identical to the current selection",function(){var a=d.add(".orange");expect(a).to.have.length(1),expect(a[0]).to.be(d[0])}),it("occurs after current selection",function(){var a=d.add(".pear");expect(a).to.have.length(2),expect(a[0]).to.be(d[0]),expect(a[1]).to.be(e[0])}),it("contains the current selection",function(){var a=d.add("#fruits");expect(a).to.have.length(2),expect(a[0]).to.be(b[0]),expect(a[1]).to.be(d[0])}),it("is a child of the current selection",function(){var a=b.add(".orange");expect(a).to.have.length(2),expect(a[0]).to.be(b[0]),expect(a[1]).to.be(d[0])})}),describe("matched elements",function(){it("occur before the current selection",function(){var a=e.add(".apple, .orange");expect(a).to.have.length(3),expect(a[0]).to.be(c[0]),expect(a[1]).to.be(d[0]),expect(a[2]).to.be(e[0])}),it("include the current selection",function(){var a=e.add("#fruits li");expect(a).to.have.length(3),expect(a[0]).to.be(c[0]),expect(a[1]).to.be(d[0]),expect(a[2]).to.be(e[0])}),it("occur after the current selection",function(){var a=c.add(".orange, .pear");expect(a).to.have.length(3),expect(a[0]).to.be(c[0]),expect(a[1]).to.be(d[0]),expect(a[2]).to.be(e[0])}),it("occur within the current selection",function(){var a=b.add("#fruits li");expect(a).to.have.length(4),expect(a[0]).to.be(b[0]),expect(a[1]).to.be(c[0]),expect(a[2]).to.be(d[0]),expect(a[3]).to.be(e[0])})})}),it(", context)",function(){var a=b.add("li","#vegetables");expect(a).to.have.length(3),expect(a[0]).to.be(b[0]),expect(a[1]).to.be(f[0]),expect(a[2]).to.be(g[0])})}),describe("(element) :",function(){describe("honors document order when element occurs",function(){it("before the current selection",function(){var a=d.add(c[0]);expect(a).to.have.length(2),expect(a[0]).to.be(c[0]),expect(a[1]).to.be(d[0])}),it("after the current selection",function(){var a=d.add(e[0]);expect(a).to.have.length(2),expect(a[0]).to.be(d[0]),expect(a[1]).to.be(e[0])}),it("within the current selection",function(){var a=b.add(d[0]);expect(a).to.have.length(2),expect(a[0]).to.be(b[0]),expect(a[1]).to.be(d[0])}),it("as an ancestor of the current selection",function(){var a=d.add(b[0]);expect(a).to.have.length(2),expect(a[0]).to.be(b[0]),expect(a[1]).to.be(d[0])})}),it("does not insert an element already contained within the current selection",function(){var a=c.add(c[0]);expect(a).to.have.length(1),expect(a[0]).to.be(c[0])})}),describe("([elements]) : elements",function(){it("occur before the current selection",function(){var b=e.add(a(".apple, .orange").get());expect(b).to.have.length(3),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0]),expect(b[2]).to.be(e[0])}),it("include the current selection",function(){var b=e.add(a("#fruits li").get());expect(b).to.have.length(3),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0]),expect(b[2]).to.be(e[0])}),it("occur after the current selection",function(){var b=c.add(a(".orange, .pear").get());expect(b).to.have.length(3),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0]),expect(b[2]).to.be(e[0])}),it("occur within the current selection",function(){var f=b.add(a("#fruits li").get());expect(f).to.have.length(4),expect(f[0]).to.be(b[0]),expect(f[1]).to.be(c[0]),expect(f[2]).to.be(d[0]),expect(f[3]).to.be(e[0])})}),it("(html) : correctly parses and adds the new elements",function(){var a=c.add('<li class="banana">banana</li>');expect(a).to.have.length(2),expect(a.is(".apple")).to.be(!0),
expect(a.is(".banana")).to.be(!0)}),describe("(selection) :",function(){describe("element in selection",function(){it("occurs before current selection",function(){var b=d.add(a(".apple"));expect(b).to.have.length(2),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0])}),it("is identical to the current selection",function(){var b=d.add(a(".orange"));expect(b).to.have.length(1),expect(b[0]).to.be(d[0])}),it("occurs after current selection",function(){var b=d.add(a(".pear"));expect(b).to.have.length(2),expect(b[0]).to.be(d[0]),expect(b[1]).to.be(e[0])}),it("contains the current selection",function(){var c=d.add(a("#fruits"));expect(c).to.have.length(2),expect(c[0]).to.be(b[0]),expect(c[1]).to.be(d[0])}),it("is a child of the current selection",function(){var c=b.add(a(".orange"));expect(c).to.have.length(2),expect(c[0]).to.be(b[0]),expect(c[1]).to.be(d[0])})}),describe("elements in the selection",function(){it("occur before the current selection",function(){var b=e.add(a(".apple, .orange"));expect(b).to.have.length(3),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0]),expect(b[2]).to.be(e[0])}),it("include the current selection",function(){var b=e.add(a("#fruits li"));expect(b).to.have.length(3),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0]),expect(b[2]).to.be(e[0])}),it("occur after the current selection",function(){var b=c.add(a(".orange, .pear"));expect(b).to.have.length(3),expect(b[0]).to.be(c[0]),expect(b[1]).to.be(d[0]),expect(b[2]).to.be(e[0])}),it("occur within the current selection",function(){var f=b.add(a("#fruits li"));expect(f).to.have.length(4),expect(f[0]).to.be(b[0]),expect(f[1]).to.be(c[0]),expect(f[2]).to.be(d[0]),expect(f[3]).to.be(e[0])})})})}),describe(".addBack",function(){describe("() : ",function(){it("includes siblings and self",function(){var b=a(".orange").siblings().addBack();expect(b).to.have.length(3),expect(b[0]).to.be(a(".apple")[0]),expect(b[1]).to.be(a(".orange")[0]),expect(b[2]).to.be(a(".pear")[0])}),it("includes children and self",function(){var b=a("#fruits").children().addBack();expect(b).to.have.length(4),expect(b[0]).to.be(a("#fruits")[0]),expect(b[1]).to.be(a(".apple")[0]),expect(b[2]).to.be(a(".orange")[0]),expect(b[3]).to.be(a(".pear")[0])}),it("includes parent and self",function(){var b=a(".apple").parent().addBack();expect(b).to.have.length(2),expect(b[0]).to.be(a("#fruits")[0]),expect(b[1]).to.be(a(".apple")[0])}),it("includes parents and self",function(){var a=cheerio.load(food),b=a(".apple").parents().addBack();expect(b).to.have.length(3),expect(b[0]).to.be(a("#food")[0]),expect(b[1]).to.be(a("#fruits")[0]),expect(b[2]).to.be(a(".apple")[0])})}),it("(filter) : filters the previous selection",function(){var b=a("li").eq(1).addBack(".apple");expect(b).to.have.length(2),expect(b[0]).to.be(a(".apple")[0]),expect(b[1]).to.be(a(".orange")[0])})})});